<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>ecstaz</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <script>
      window.rootPrefix = /^\/(files|preview)\//.test(location.pathname)
        ? location.pathname.split('/').slice(0, 4).join('/')
        : '/';
    </script>
    <script type="module" src="../webfoundry/ifdesigner.js"></script>
    <script src="../webfoundry/head.js"></script>
  </head>
  <body
    class="flex flex-col [&amp;&gt;div:first-child]:flex-1 min-h-screen"
    style="display: none"
  >
    <div
      class="flex flex-col flex-1"
      wf-onattach="post('ecstaz.init')"
      wf-ondetach="post('ecstaz.teardown')"
    >
      <div class="flex-1 bg-neutral-950">
        <style>
          .prose {
            font-size: inherit;
            line-height: 1.75;
            color: inherit;
          }

          .prose > * {
            margin-block: 1.25rem;
          }

          .prose > :first-child {
            margin-top: 0;
          }

          .prose > :last-child {
            margin-bottom: 0;
          }

          .prose > h1,
          .prose > h2,
          .prose > h3,
          .prose > h4,
          .prose > h5,
          .prose > h6 {
            font-weight: 600;
            line-height: 1.2;
            letter-spacing: -0.01em;
          }

          .prose > h1 {
            font-size: clamp(2.25rem, 4vw, 3rem);
          }

          .prose > h2 {
            font-size: clamp(1.75rem, 3vw, 2.25rem);
          }

          .prose > h3 {
            font-size: clamp(1.35rem, 2.5vw, 1.75rem);
          }

          .prose > ul,
          .prose > ol {
            padding-left: 1.5rem;
            margin-block: 1.25rem;
          }

          .prose ul ul,
          .prose ol ol {
            margin-block: 0.5rem;
          }

          .prose ul {
            list-style: disc;
          }

          .prose ol {
            list-style: decimal;
          }

          .prose li {
            margin-block: 0.25rem;
          }

          .prose > blockquote {
            border-left: 3px solid rgba(148, 163, 184, 0.4);
            padding-left: 1.25rem;
            font-style: italic;
            color: rgba(226, 232, 240, 0.7);
          }

          .prose > pre {
            background: rgb(15 23 42 / 0.7);
            padding: 1rem 1.25rem;
            border-radius: 1rem;
            font-size: 0.9rem;
            overflow-x: auto;
            border: 1px solid rgba(148, 163, 184, 0.2);
          }

          .prose code {
            font-family:
              'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, Monaco,
              Consolas, 'Liberation Mono', 'Courier New', monospace;
            background: rgb(15 23 42 / 0.6);
            padding: 0.15rem 0.4rem;
            border-radius: 0.5rem;
            font-size: 0.85em;
          }

          .prose pre code {
            background: transparent;
            padding: 0;
          }

          .prose strong,
          .prose b {
            font-weight: 600;
          }

          .prose em,
          .prose i {
            font-style: italic;
          }

          .prose > table,
          .prose table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
            overflow: hidden;
            border-radius: 1rem;
            border: 1px solid rgba(148, 163, 184, 0.25);
          }

          .prose table th,
          .prose table td {
            border: 1px solid rgba(148, 163, 184, 0.25);
            padding: 0.65rem 0.75rem;
            text-align: left;
          }

          .prose table th {
            background: rgb(15 23 42 / 0.6);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            font-size: 0.75rem;
            color: rgba(248, 250, 252, 0.75);
          }

          .prose table tbody tr:nth-child(odd) {
            background: rgb(15 23 42 / 0.3);
          }

          .prose a {
            text-decoration: underline;
          }

          .prose > hr {
            border: none;
            border-top: 1px solid rgba(148, 163, 184, 0.3);
            margin-block: 2rem;
          }

          .prose [contenteditable]:focus,
          [contenteditable].prose:focus {
            outline: none !important; /* suppress UA outline safely */
          }

          [contenteditable][data-placeholder]:empty:before {
            content: attr(data-placeholder);
            color: rgba(148, 163, 184, 0.6);
            pointer-events: none;
          }
        </style>
        <div
          wf-if="state.ecstaz.ready"
          class="max-w-5xl mx-auto px-6 py-12 flex flex-col gap-10 text-neutral-100"
        >
          <div class="flex flex-col gap-6">
            <div class="flex items-start justify-between gap-6 flex-wrap">
              <div class="flex-1 min-w-[250px]">
                <div
                  class="text-xs tracking-[0.65em] uppercase text-neutral-500"
                >
                  <input
                    wf-if="state.ecstaz.editable"
                    type="text"
                    class="bg-transparent w-full focus:outline-none border-none focus:ring-0 uppercase tracking-[0.65em] text-xs text-neutral-400"
                    placeholder="Click to set site label"
                    wf-value="state.ecstaz.siteTitleDraft"
                    wf-onfocus="post('ecstaz.siteTitleFocus', event)"
                    wf-oninput="post('ecstaz.siteTitleInput', event)"
                    wf-onblur="post('ecstaz.siteTitleBlur', event)"
                    value=""
                    hidden=""
                  />
                  <div wf-if="!state.ecstaz.editable">
                    {{state.ecstaz.siteTitle}}
                  </div>
                </div>
                <div class="mt-4">
                  <input
                    wf-if="state.ecstaz.editable"
                    type="text"
                    class="w-full bg-transparent text-4xl sm:text-5xl font-light leading-tight text-neutral-100 focus:outline-none border-none focus:ring-0 px-0"
                    wf-value="state.ecstaz.titleDraft"
                    wf-onfocus="post('ecstaz.titleInputFocus', event)"
                    wf-oninput="post('ecstaz.titleInput', event)"
                    wf-onblur="post('ecstaz.titleInputBlur', event)"
                    value=""
                    placeholder="Click here to name the page"
                    hidden=""
                  />
                  <div
                    wf-if="!state.ecstaz.editable"
                    class="text-4xl sm:text-5xl font-light leading-tight"
                  >
                    {{state.ecstaz.activePage.title}}
                  </div>
                </div>
              </div>
              <div
                class="flex items-center justify-end gap-3 flex-wrap"
                wf-if="state.ecstaz.editable"
              >
                <button
                  class="h-11 w-11 rounded-full border border-neutral-800 flex items-center justify-center text-lg hover:border-neutral-100 transition-colors"
                  wf-onclick="post('ecstaz.requestCreatePage')"
                  aria-label="New page"
                  value=""
                >
                  <span class="nf nf-fa-plus"></span>
                </button>
                <button
                  class="h-11 w-11 rounded-full border border-neutral-800 flex items-center justify-center text-lg transition-colors hover:border-neutral-100"
                  wf-onclick="post('ecstaz.requestArchivePage')"
                  aria-label="Archive page"
                  value=""
                >
                  <span class="nf nf-oct-x"></span>
                </button>
                <div class="flex items-center gap-2 flex-wrap justify-end">
                  <button
                    wf-map="page of state.ecstaz.pageList"
                    class="px-4 py-1.5 rounded-full text-[11px] tracking-[0.25em] uppercase border border-neutral-800 text-neutral-400 hover:border-neutral-200 hover:text-neutral-50 transition-colors"
                    wf-class="{{state.ecstaz.currentPath === page.key ? 'border-neutral-50 text-neutral-50' : ''}}"
                    wf-onclick="post('ecstaz.selectPage', page.key)"
                    value=""
                  >
                    {{page.title}}
                  </button>
                </div>
              </div>
              <div class="w-full -mt-3">
                <input
                  wf-if="state.ecstaz.editable"
                  type="text"
                  class="w-full bg-transparent leading-tight font-light text-neutral-100 focus:outline-none border-none focus:ring-0 px-0 placeholder:italic text-3xl"
                  placeholder="Click here to enter a page heading"
                  wf-value="state.ecstaz.activePage.heading"
                  wf-oninput="post('ecstaz.updateHeading', event)"
                  wf-onblur="post('ecstaz.persist')"
                  value=""
                  hidden=""
                />
                <div
                  wf-if="!state.ecstaz.editable &amp;&amp; state.ecstaz.activePage.heading"
                  class="leading-tight font-light text-3xl"
                >
                  {{state.ecstaz.activePage.heading}}
                </div>
              </div>
            </div>
            <div class="text-xs text-amber-400" wf-if="state.ecstaz.flash">
              {{state.ecstaz.flash}}
            </div>
            <div
              class="relative"
              wf-ondetach="post('ecstaz.detachPaletteHost')"
              wf-onattach="post('ecstaz.attachPaletteHost', _1)"
            >
              <div class="prose">
                <div
                  class="min-h-[420px]"
                  wf-ondetach="post('ecstaz.detachEditor')"
                  wf-onattach="post('ecstaz.attachEditor', _1)"
                ></div>
              </div>
              <div
                class="absolute z-20 pointer-events-none"
                wf-if="state.ecstaz.editable &amp;&amp; state.ecstaz.commandPalette.active"
                wf-ondetach="post('ecstaz.detachCommandPaletteEl')"
                wf-onattach="post('ecstaz.attachCommandPaletteEl', _1)"
                hidden=""
              >
                <div class="pointer-events-auto flex flex-col gap-2">
                  <div
                    class="inline-flex items-center gap-2 rounded-full border border-neutral-800 bg-neutral-900/95 px-3 py-1.5 text-sm text-neutral-400 shadow-xl"
                  >
                    <span class="text-lg leading-none text-neutral-500">/</span>
                    <input
                      type="text"
                      class="bg-transparent placeholder:text-neutral-600 focus:outline-none text-neutral-100 text-sm w-28 sm:w-32"
                      placeholder="Filter..."
                      value=""
                      wf-oninput="post('ecstaz.updateCommandFilter', event)"
                      wf-onkeydown="post('ecstaz.commandFilterKeydown', event)"
                      wf-onattach="post('ecstaz.commandFilterInputAttach', _1)"
                      wf-ondetach="post('ecstaz.commandFilterInputDetach')"
                      wf-value="state.ecstaz.commandFilter"
                    />
                  </div>
                  <div
                    class="bg-neutral-950/95 border border-neutral-900 rounded-3xl shadow-2xl max-w-md w-full max-h-[50vh] overflow-auto"
                  >
                    <div
                      wf-if="state.ecstaz.filteredPalette.length"
                      class="divide-y divide-neutral-900"
                    >
                      <div
                        wf-map="section of state.ecstaz.filteredPalette"
                        class="px-4 py-4 flex flex-col gap-3"
                      >
                        <div
                          class="text-xs uppercase tracking-[0.35em] text-neutral-500"
                        >
                          {{section.title}}
                        </div>
                        <div class="flex flex-col gap-1">
                          <button
                            wf-map="item of section.items"
                            class="flex w-full items-center gap-3 rounded-2xl border border-transparent px-3 py-2 text-left transition-colors hover:border-neutral-700 hover:bg-neutral-900"
                            wf-class="{{item.activeKey &amp;&amp; state.ecstaz.editor?.isActive(item.activeKey, item.activeAttrs || {}) ? 'border-neutral-700 bg-neutral-900/70' : ''}}"
                            wf-onclick="post('ecstaz.paletteSelect', item.id)"
                            value=""
                            type="button"
                          >
                            <div
                              class="h-10 w-10 rounded-2xl border border-neutral-800 bg-neutral-900/70 flex items-center justify-center"
                            >
                              <span
                                class="text-lg text-neutral-100"
                                wf-class="{{item.icon ? item.icon : 'nf-md-shape'}}"
                              ></span>
                            </div>
                            <div class="flex-1">
                              <div class="text-sm text-neutral-100">
                                {{item.label}}
                              </div>
                              <div
                                wf-if="item.description"
                                class="text-xs text-neutral-500"
                              >
                                {{item.description}}
                              </div>
                            </div>
                          </button>
                        </div>
                      </div>
                    </div>
                    <div
                      wf-if="!state.ecstaz.filteredPalette.length"
                      class="px-4 py-6 text-center text-sm text-neutral-500"
                    >
                      <div wf-if="state.ecstaz.commandFilter">
                        No matches for "{{state.ecstaz.commandFilter}}".
                      </div>
                      <div wf-if="!state.ecstaz.commandFilter">
                        Start typing to filter blocks.
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div
                class="absolute z-10 pointer-events-none"
                wf-if="state.ecstaz.editable &amp;&amp; state.ecstaz.formatBar.visible"
                wf-onattach="post('ecstaz.attachFormatBarEl', _1)"
                wf-ondetach="post('ecstaz.detachFormatBarEl')"
                hidden=""
              >
                <div
                  class="pointer-events-auto flex items-center gap-3 rounded-full border border-neutral-900 bg-neutral-950/90 px-4 py-1 shadow-xl"
                  wf-onmousedown="post('ecstaz.formatBarPointerDown', event)"
                >
                  <div
                    class="text-neutral-500 text-lg select-none cursor-move"
                    aria-hidden="true"
                  >
                    ⋮⋮
                  </div>
                  <button
                    class="text-sm px-2 py-1 rounded-full border border-transparent hover:border-neutral-700 hover:bg-neutral-900"
                    wf-class="{{state.ecstaz.editor?.isActive('bold') ? 'border-neutral-700 bg-neutral-900/70' : ''}}"
                    wf-onclick="post('ecstaz.command', 'bold')"
                    type="button"
                    value=""
                  >
                    B
                  </button>
                  <button
                    class="text-sm px-2 py-1 rounded-full border border-transparent hover:border-neutral-700 hover:bg-neutral-900"
                    wf-class="{{state.ecstaz.editor?.isActive('italic') ? 'border-neutral-700 bg-neutral-900/70' : ''}}"
                    wf-onclick="post('ecstaz.command', 'italic')"
                    type="button"
                    value=""
                  >
                    I
                  </button>
                  <button
                    class="text-sm px-2 py-1 rounded-full border border-transparent hover:border-neutral-700 hover:bg-neutral-900"
                    wf-class="{{state.ecstaz.editor?.isActive('heading', { level: 2 }) ? 'border-neutral-700 bg-neutral-900/70' : ''}}"
                    wf-onclick="post('ecstaz.command', 'h2')"
                    type="button"
                    value=""
                  >
                    H2
                  </button>
                  <button
                    class="text-sm px-2 py-1 rounded-full border border-transparent hover:border-neutral-700 hover:bg-neutral-900"
                    wf-class="{{state.ecstaz.editor?.isActive('heading', { level: 3 }) ? 'border-neutral-700 bg-neutral-900/70' : ''}}"
                    wf-onclick="post('ecstaz.command', 'h3')"
                    type="button"
                    value=""
                  >
                    H3
                  </button>
                </div>
              </div>
              <div
                class="absolute z-10 pointer-events-none"
                wf-if="state.ecstaz.editable &amp;&amp; state.ecstaz.gridUi.active"
                wf-onattach="post('ecstaz.attachGridPanelEl', _1)"
                wf-ondetach="post('ecstaz.detachGridPanelEl')"
                hidden=""
              >
                <div
                  class="pointer-events-auto border border-neutral-900 rounded-3xl bg-neutral-950/95 p-4 space-y-4 shadow-2xl min-w-[320px]"
                >
                  <div
                    class="text-xs uppercase tracking-[0.35em] text-neutral-500"
                  >
                    Grid Controls
                  </div>
                  <div class="flex flex-wrap items-center gap-6">
                    <div class="flex flex-col gap-2">
                      <label
                        class="text-[10px] uppercase tracking-[0.35em] text-neutral-500"
                        >Columns</label
                      >
                      <input
                        type="range"
                        min="1"
                        max="4"
                        step="1"
                        class="w-44 accent-neutral-200"
                        wf-onattach="post('ecstaz.bindGridInput', 'cols', _1)"
                        wf-oninput="post('ecstaz.gridUiChangeCols', event)"
                        value="3"
                      />
                      <div class="text-sm text-neutral-400">
                        {{state.ecstaz.gridUi.cols}} columns
                      </div>
                    </div>
                    <div class="flex flex-col gap-2">
                      <label
                        class="text-[10px] uppercase tracking-[0.35em] text-neutral-500"
                        >Gap (rem)</label
                      >
                      <input
                        type="range"
                        min="0.25"
                        max="6"
                        step="0.25"
                        class="w-44 accent-neutral-200"
                        wf-onattach="post('ecstaz.bindGridInput', 'gap', _1)"
                        wf-oninput="post('ecstaz.gridUiChangeGap', event)"
                        value="3.25"
                      />
                      <div class="text-sm text-neutral-400">
                        Gap {{state.ecstaz.gridUi.gap}} rem
                      </div>
                    </div>
                  </div>
                  <div class="space-y-2">
                    <div
                      class="text-[10px] uppercase tracking-[0.35em] text-neutral-500"
                    >
                      Column widths
                    </div>
                    <div class="flex flex-col gap-3">
                      <div
                        wf-map="entry of state.ecstaz.gridUi.entries"
                        class="flex flex-wrap items-center gap-2"
                      >
                        <span class="text-xs text-neutral-500"
                          >Col {{entry.idx + 1}}</span
                        >
                        <input
                          type="text"
                          class="w-20 rounded-2xl border border-neutral-800 bg-neutral-950/80 px-3 py-1 text-sm text-neutral-100"
                          placeholder="1fr"
                          wf-onattach="post('ecstaz.bindGridWidthInput', entry.idx, _1)"
                          wf-onchange="post('ecstaz.gridUiChangeWidth', entry.idx, event)"
                          value=""
                        />
                        <label class="text-xs text-neutral-500">Col span</label>
                        <input
                          type="number"
                          min="1"
                          max="4"
                          class="w-16 rounded-2xl border border-neutral-800 bg-neutral-950/80 px-2 py-1 text-sm text-neutral-100"
                          wf-value="entry.colSpan"
                          wf-onchange="post('ecstaz.gridUiChangeColSpan', entry.idx, event)"
                          value=""
                        />
                        <label class="text-xs text-neutral-500">Row span</label>
                        <input
                          type="number"
                          min="1"
                          max="4"
                          class="w-16 rounded-2xl border border-neutral-800 bg-neutral-950/80 px-2 py-1 text-sm text-neutral-100"
                          wf-value="entry.rowSpan"
                          wf-onchange="post('ecstaz.gridUiChangeRowSpan', entry.idx, event)"
                          value=""
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div
        wf-if="!state.ecstaz.ready"
        class="flex items-center justify-center py-32 text-neutral-500 text-sm"
        hidden=""
      >
        Loading the monochrome builder…
      </div>
    </div>
  </body>
</html>
